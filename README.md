# 相模原ダルク 電話対応支援システム

## 📋 プロジェクト概要

一般社団法人相模原ダルクの電話相談業務を効率化・標準化するための電話対応支援Webアプリケーションです。
電話対応マニュアルに基づいた段階的なガイド機能と、相談記録の管理・分析機能を提供します。

### 代表理事
**田中秀泰** - 薬物・アルコール・ギャンブル依存症者及びその家族への回復支援と社会復帰をサポート

## 🎯 主な機能

### ✅ 現在完成している機能

1. **新規相談受付システム**
   - 段階的電話対応ガイド（オープニング→傾聴→情報提供→クロージング）
   - リアルタイム対応フレーズ表示（OK例・NG例・ルール・注意事項）
   - 詳細な相談記録シート入力フォーム
   - 緊急度評価システム（高・中・低の3段階）
   - チェックリスト機能

2. **データベース管理**
   - Cloudflare D1による永続的データ保存
   - 相談記録の完全管理
   - スタッフ情報管理
   - 対応フレーズ集管理

3. **API機能**
   - RESTful API設計
   - スタッフ一覧取得
   - 対応フレーズ取得（カテゴリー別）
   - 相談記録CRUD操作
   - 検索機能
   - 統計情報取得

### 🚧 今後実装予定の機能

1. **相談履歴管理**
   - 過去の相談記録一覧表示
   - 詳細検索機能
   - 記録の編集・削除機能

2. **統計ダッシュボード**
   - 相談傾向の可視化
   - 依存症種類別統計
   - 緊急度別分析
   - 月次・年次レポート

3. **対応マニュアル閲覧**
   - フレーズ集の詳細表示
   - カテゴリー別フィルター
   - キーワード検索

4. **エクスポート機能**
   - 相談記録のPDF出力
   - CSV形式でのデータエクスポート

## 🌐 公開URL

### 開発環境（Sandbox）
- **アプリURL**: https://3000-iko5o0a9up8u6girs6d0a-2e77fc33.sandbox.novita.ai
- **API Base**: https://3000-iko5o0a9up8u6girs6d0a-2e77fc33.sandbox.novita.ai/api

### 本番環境（デプロイ後）
- **Production URL**: （デプロイ後に追加）
- **GitHub Repository**: （GitHub連携後に追加）

## 📊 データアーキテクチャ

### データモデル

#### 1. 相談記録（consultations）
- 受付情報（日時、対応者）
- 基本情報（名前、年齢、性別、電話番号、相談者の関係）
- 依存症情報（種類、期間、頻度、重症度）
- 医療・治療歴（入院歴、通院歴、服薬状況、他施設利用）
- 緊急度評価（24時間以内使用、離脱症状、自傷他害、医療必要性、判定レベル）
- 相談内容・特記事項
- 次のアクション（面談予約、フォローアップ、連携先、報告）
- チェックリスト（6項目）

#### 2. 対応フレーズ（response_phrases）
- カテゴリー（opening, listening, information, closing, emergency）
- 段階（第1〜4段階）
- フレーズ種類（OK例、NG例、ルール、注意）
- フレーズ内容

#### 3. スタッフ（staff）
- 名前
- 役職（代表理事、上級スタッフ、スタッフ）
- 有効/無効フラグ

### ストレージサービス
- **Cloudflare D1（SQLite）**: 全データの永続化
- **ローカル開発**: `.wrangler/state/v3/d1`に自動作成されるSQLiteデータベース

### データフロー
1. フロントエンド（JavaScript）→ Hono API（TypeScript）
2. Hono API → Cloudflare D1 Database
3. データベース → API → フロントエンド

## 📱 依存症対応範囲

以下の依存症に対応しています：
- アルコール依存
- 薬物依存
- ギャンブル依存
- ゲーム依存
- ネット・スマホ依存
- 処方薬・市販薬依存
- 窃盗（クレプトマニア）
- 性依存
- 共依存
- 食行動の問題
- その他

## 👥 利用ガイド

### 新規相談を受ける場合

1. **ホーム画面**から「新規相談受付」をクリック
2. **左側の対応ガイド**を参考にしながら電話対応
3. **右側の記録シート**に情報を入力：
   - 受付情報（日時、対応者名）を入力
   - 相談者の基本情報を記録
   - 依存症の種類や状況を選択
   - 緊急度を評価（重要！）
   - 相談内容を詳細に記録
   - 次のアクション（面談予約など）を設定
4. **チェックリスト**を確認
5. 「相談記録を保存」ボタンをクリック

### 対応の4段階

#### 第1段階: オープニング（0-30秒）
- 名前を名乗り、相手の話を聞く姿勢を示す
- 例：「お電話ありがとうございます。相模原ダルクの〇〇と申します。本日はどのようなご相談でしょうか？」

#### 第2段階: 傾聴・共感（30秒-5分）
- 相手の話を遮らず、最後まで聞く
- 共感を示す言葉をかける
- 例：「そうだったんですね。それはとてもお辛い状況だったと思います。」

#### 第3段階: 情報提供（5-10分）
- 施設概要を説明（30秒スピーチ）
- 対応可能な依存症を伝える
- 面談予約の案内

#### 第4段階: クロージング
- 名前・連絡先の確認
- 緊急度の評価
- フォローアップ日の設定
- 例：「本日はお電話いただき、ありがとうございました。◯月◯日の◯時にお待ちしております。」

### 緊急対応が必要な場合

以下の場合は最優先対応：
- ✅ 24時間以内の使用がある
- ✅ 離脱症状がある
- ✅ 自傷・他害の恐れがある
- ✅ 医療機関への受診が必要

→ **緊急度「高」**を選択し、即日対応をスケジュール

## 🚀 デプロイ状況

### ローカル開発環境
- ✅ 開発環境構築完了
- ✅ データベースマイグレーション完了
- ✅ 初期データ投入完了
- ✅ PM2によるサービス起動完了
- ✅ API動作確認完了

### 本番環境（Cloudflare Pages）
- ⏳ デプロイ待ち

## 💻 技術スタック

### フロントエンド
- **HTML5 + JavaScript (ES6+)**
- **Tailwind CSS** (CDN) - レスポンシブデザイン
- **Font Awesome** - アイコン
- **Axios** - HTTP通信
- **SPA Architecture** - シングルページアプリケーション

### バックエンド
- **Hono Framework** - 高速軽量Webフレームワーク
- **TypeScript** - 型安全な開発
- **Cloudflare Workers** - エッジランタイム
- **Cloudflare Pages** - ホスティング

### データベース
- **Cloudflare D1** - SQLiteベースのグローバル分散データベース
- **Wrangler** - CLIツール

### 開発環境
- **Vite** - ビルドツール
- **PM2** - プロセスマネージャー
- **Git** - バージョン管理

## 📈 推奨される次のステップ

1. **相談履歴画面の実装** - 過去データの閲覧・検索機能
2. **統計ダッシュボードの強化** - グラフ化・可視化
3. **PDF/CSV エクスポート** - 報告書作成支援
4. **ユーザー認証機能** - スタッフごとのログイン
5. **モバイル最適化** - タブレット・スマホ対応強化
6. **本番デプロイ** - Cloudflare Pages へのデプロイ

## 📞 お問い合わせ

**一般社団法人相模原ダルク**
- 代表理事: 田中秀泰
- 事業内容: 薬物・アルコール・ギャンブル依存症からの回復支援と社会復帰サポート
- 対象: 在日外国人、貧困家庭、機能不全家族、特に子どもたちへの包括的支援

## 📄 ライセンス

© 2026 一般社団法人相模原ダルク - All Rights Reserved

---

**最終更新日**: 2026年1月26日  
**開発状況**: ✅ コア機能完成 | 🚧 拡張機能開発中
